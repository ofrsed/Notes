# Особенности Linux

| Windows | Linux |
| --- | --- |
| Диски `C:\`,`D:\`,`F:\` | В виде дерева с единой точкой входа `/` |
| Командныее интепретаторы  PowerShell, cmd.exe | sh, bash, csh, ksh, zsh... |
| Переменные среды скрыты от пользователя | Пользователь взаимодействует с переменными средами |
| Гибридное ядро | Монолитное |
| Модель с потоками (thread) | Клонирования процессов (fork) |

Особенности linux: 
- Все есть файл
- Маленькие программы, работающие вместе
- Стандартные потоки (stdin, stdout, stderr)

# Иерархия файловой системы
- `/mnt` - подключение временных файловых систем
- `/tmp` - директория для временных файлов
- `/opt` - размещение доп програмного обеспечения в системе
- `/etc` - хранение большинства файлов конфигурации в linux
- `/home` - лмчные данные пользователя и персональные настройки
- `/var` - директория хранящая изменяемые файлы
- `/bin` - для основных утилит 
- `/boot` - файлы, связанные с загрузкой
- `/dev` - файлы, связанные с устройствами
- `/lib` - библиотеки, неоюходимые для исполняемых файлов системы
- `/media` - сменные устройства (USB...)
- `/proc` - процессы исполняемые в системе в виде файлов
- `/root` - домашний каталог суперпользователя
- `/run` - данные о том что в данный момент запущенно
- `/sbin` - системные утилиты
- `/srv` - службы размещают свои данные
- `/sys` - информация об устройствах и их драйверах
- `/usr` - вторичная иерархия для данных пользователя


Ядро - программа находящаяся  памяти, отдаюцая команды CPU
Ядро отвечает за состояние память, за то, каким процессам разрешен доступ к процессору. Оно связывает аппаратную часть (железо) с процессами. Отвечает за смену контекста

С ядром каждая программа работает в собственных откужениях

| Микроядро | Монолитное | Гибридное ядро |
| --- | --- | --- |
|Высокая стабильность, Низкая скорость| Высокая производительность, Отказоустойчивость ниже| Вожможность выбирать из преимущест монолита и микроядра |

Ядро отвечает за 5 основных задач
- Управление памятью
- Управление процессами
- Функционирование драйверов устройств
- Системные вызовы
- Безопасность

# Работа с железом
- `dmesg` - вывод буфера сообщений ядра
- `udevadm info -n <устройство>` - запрос в базу с информацией об устройствах
- `udevadm monitor` - слушает события
- `lspci` - информация о pci шинах и устройствах на них
- `lsblk` - информация о блочных устройствах 
- `lscpu` - информация о CPU
- `lsmem` - список доступной памяти в системе
- `free` - общий объем памяти по сравенению с использованной
- `lshw` - вся конфигурация машины

# Типы файлов

|Идентификатор|Тип файла|
|-|-|
|`d`|Directory(Каталог)|
|`-`|Regular File (Обычный файл)|
|`c`|Character Devece (Символьное устройство)|
|`b`|Block Device (Блочное устройство)|
|`l`|Link(Ссылка)|
|`s`|Socket File(Сокет-файл)|
|`p`|Pipe(Канал)|
|`D`|Door(Дверь)|

# Bash
- `tar` - создать архив
- `locate <имя файла>` - найти файл
- `updatedb` - обновляет БД locate
- `find <путь> -name <имя файла>` -
- `grep <что ищем> <имя файла>` - найти строку в файле
- `grep -i <что ищем> <имя файла>` - найти строку в файле без учета регистра
- `grep -i end <что ищем> <имя файла>` - найти строку рекурсивно
- `awk` - поиск
- `echo $SHELL > shell.txt` - перенаправление потока вывода
- `echo 'My shell in bash' >> shell.txt` - дописать в файл
- `echo nofile 2> errors.txt` - перенаправить вывод ошибки
- `ls shell.txt && echo 'ok'` - если код возврата первой команды 0 (успешно) то выполняется вторая, если код 1 (не выполнено) - операция прерывается
- `ls shell.txt || echo 'ok'` - вторая команда выполнится, если первая не выполнится (оператор ИЛИ)
- `grep Nice hreetings.txt | less` - пайп (Line pipes)

- `tail` - печатает последние несколько строк (по умолчанию 10 строк) определенного файла, а затем завершает работу


# Текстовые редакторы
`VI``nano` `emacs`

`vi`/`vim`
- `vi` - открыть файл в коммандном режиме Command mode
- `o a i ins` - переключиться в режим Insert mode. `ESC` - вернуться в Command mode
- `:` - переключиться в режим последней строки last line
-`command mode`
 - `стрелки + hjkl` - перемешение 
 - `быстро yy` - скопировать
 - `p` - вставить
 - `x` - удалить символ
 - `dd` - удалить строку
 - `u` - откат на предыдущее состояние
 - `r` - вернуть предыдущее изменение
 - `/<шаблон>` - найти строку
 - `n`, `N` - найти следущее \ предыдущее
-`Insert mode`
 - все как обычно
- `last line` 
 - `:w` - сохранить файл
 - `:q` - выйти из редактора
 - `:wq` - созранить и выйти
 - `:q!` - выйте без сохранения



- `` - 
- `` - 


Лучше устанавливать файлы из репазитория, а то может поломаться ОС
запустить терминал Ctrl + Alt + T

`pwd` — печатает текущую директорию (папки)

`ls` — List directory content — вывести содержимое директории

```
Общий вид команды: команда опции аргументы
```

`ls -l` — выводит все списком с доп информацией

`ls --а`     -all — покажет все фацлы и папки, включая скрытые

`ls -h`     --human-readable — показывает привычно человеку

-   покавывает что это не путь, а опция, можно ввести -ahl, порядок неважен
все скрытые папки начинаются с точки

`man команда` — справка о команде, q выход
`--help` - краткая справка

`clear` - `Ctrl + l`  — очистить терминал

`exit` - `Ctrl + D` - закрыть терминал


Перемещение в терминале:
`Стрелка вверх\вниз` — перемещение по введенным ранее командам
`стрелка вправо\влево` — перемещение по команде
`Ctrl + A` — перейти в начало
`Ctrl + E` — перейти в конец
`Ctrl + Shift + C` - копировать
`Ctrl + Shift + V` - вставить

Устройство путей
`which <имя программы>` - показывает путь до файла

Абсолютный путь — путь от главной директории (от корневой). Начинается всегда со слеша
```/home/bi/Documents/usr/bin/getit```
Относительный путь — путь от текущей директории
```Documents/ust/file.txt```

. - текущая директория
.. - директория на уровень выше
~ - домашняя директория

* - любое количество любых символов
? - ровно один любой символ

- `mkdir путь_до_дирректории` - создать директорию,
- `mkdir -p  путь_до_директории` - воздать директорию и ее «родителей»,
- `touch путь до файла` - создать файл,
- `cd путь_до директории` - войти в директорию,
- `rm путь_до_файла` - удалить файл,
- `rm -r путь_до_файла` - удалить директорию,
- `rm -rf путь_до_файла` - удалить директорию без вопросов,
- `cp путь_до_файла1 путь_до_файла2` - скопировать фаил 1 в файл 2,
- `cp -r путь_до_дир1 путь_до_дир2` - скопировать дир1 в дир2,
- `mv путь1 путь2` — переместить директорию или фаил,
 


Запуск программы
./имя_программы
/полный_путь/полный/путь/имя_программы  - запуск программы из текущей директории

Если программа не исполняемая (нет х в конце при просмотре через ls -al)  то можно ввести chmod +x имя_файла

Редактирование текстового файла с терминале
`cat фаил` - вывести содержимое на экран
`less фаил`  - открыть файл на чтение
`q` — выход  /-поиск, `g` - в начало, `G` - конец
`nano фаил` — редактировать файл, `Ctrl + X` - выход

grep
`grep “<строка>“ <файл>` - найти строку в файле
`grep -с “<строка>“ <файл>` - посчитать количество вхождений строки
`grep -r “<строка>“ <файл>` - найти строку во всех файлах в папке

Сервер
`ssh логин@адрес_сервера` (-p порт     - если по адресу  сразу несколько серверов)
`ssh-keygen` — создание ключа
`ssh-add` — сообщить системе о ключе
`cat ~/.id_rsa.pub` — просмотр публичного ключа
`nano ~/.ssh/authorised_keys` — редактирование авторизованных ключей (на сервере)

Копирование файлов
scp логин@адрес_сервера:путь1 путь2  - с сервера(путь1) на клиента (путь2)

Установка программ
`sudo apt-get install программа` — установка программ через терминал
`sudo apt-get remove программа` — удаление программы
`sudo apt-get update` — обновление ссылок на пакеты
`sudo apt-get upgrade` — обновление установленных пакетов
`sudo apt-get install —only-upgrate программа` — обновление отдельной программы

Управление програмами
`ctrl + C`  - прервать выполнение
`ctrl + Z`  - приостановить выполнение
`fg`  - продолжить (foreground)
`bg`  - продолжить в фоновом режиме (background)
`jobs` — посмотреть запущенные программы
`ps` — посмотреть все запущенные процессы
`top` — отслеживать процессы в реальном времени
`top -u <имя пользователя>` - отслеживать процессы этого пользователя
`fg %<номер>` - продолжить программу с этим номером
`bg %<номер>` - продолжить программу с этим номером в фоновом режиме

`firefox &`  - сразу запустить в фоновом режиме
`kill <>` - завершить процесс с этим номером
`kill -9 <>` -убить процесс с этим номером  

Информация о компьютере
`free -g`  - информация об оперативке
`nproc` — количество ядер в процессоре
`lscpu` - детальная информация о процессоре

Менеджер терминалов
`Ctrl + Shift + T` - открыть новую вкладку
`Alt + <цифра>` - перейти в указанную вкладку
`Ctrl + Shift + W` — закрыть текущую вкладку

`tmux`  - запустить tmux
Ctrl + B — перейти в режим команд
Ctrl + B + C — создание новой вкладки
Ctrl + B +<цифра> - перейти в указанную вкладку
Ctrl + B +N  /  Ctrl + B + P  - перейти в следующую/предыдущую вкладки
Ctrl + B +X (или exit) - закрыть вкладку
Ctrl + B + D — временно выйти из tmux
tmux attach / tmux a — вернуться в tmux
tmux list-sessions — посмотреть список запущенных tmux`ов (не понадобился)
Ctrl + B +PgUp — перейти в режим просмотра истории
PgUp, PgDown, стрелки — перемещать курсор по истории
Esc, Ctrl + C — выйти из режима просмотра

Vim — текстовый редактор

vimtutor - автотуториал
vim <файл> - открыть в vim
Режимы работы
1. normal
-режим работы по умолчанию
-любая клавиша — команда
-»сложные» команды начинаются с «:»

2. insert
-режим ввода текста
-выход через <Esc><Ctrl + C>

3. visual
- режим выделения


:q - выход
:help- справка

Bash


Поиск
find -iname “<имя файла>“ - не учитывать регистр
find -name “<имя файла>“ - ищет точно как  в запросе
find -path “<путь>“ - найти указанный путь
find -size <размер> - выводить файлы указанного размера
find -maxdepth <число> - искать не больше чем на заданное число уровней вниз
find -mindepth <число> - искать начиная с заданного числа уровней вниз

grep -l “<строка>“ <файл> - список файлов с этой строкой
grep -L “<строка>“ <файл> - список файлов, где этой строки нет
grep -n “<строка>“ <файл> - выводить номер строки в файле
grep -m <число> “<строка>“ <файл> - не искать дальше после заданного числа вхождений
grep -A <число> “<строка>“ <файл>- выводить это число строк после вхождения
grep -B <число> “<строка>“ <файл> - выводить это число строк до вхождения
grep -C <число> “<строка>“ <файл> - выводить это число строк вокруг вхождения
gtrp -E “<шаблон>“ <файл> - найти указанный шаблон в файле
      gtrp -E “<^go>“ <файл> - найти строки, начинающиеся с go
      gtrp -E “<go$>“ <файл> - найти строки, оканчивающиеся на go

Права доступа
drwxrwxr-x — dir
`-rw-rw-r--` -
- 1 символ: тип файла
- след 3:owner (для владельца)
- след 3: group (для членов группы)
- след3:othet (для всех остальных)

`r` — read — чтение, просмотр
`w` — write - редактирование
`o` — execute - запуск

chmod [ugoa] [+-] [rwx] <путь>

chown new_user:new_group <путь>  - изменить обладателя
root — суперпользователь
sudo <действие>  -сделать от имени root

разное

wc [-l -w -c] <путь> - посчитать кол-во строк, слов, символов в файле
diff [-q -r] <путь1> <путь2> - сравнить файлы\директории
df — кол-во свободного места в системе
